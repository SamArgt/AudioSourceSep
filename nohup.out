2020-05-17 23:45:25.778967: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-17 23:45:29.076635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.077433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:5e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.078150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:86:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.078854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 3 with properties: 
pciBusID: 0000:d8:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.079131: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-17 23:45:29.080799: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-17 23:45:29.082727: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-17 23:45:29.083034: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-17 23:45:29.084933: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-17 23:45:29.085975: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-17 23:45:29.090011: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-17 23:45:29.095621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2, 3
2020-05-17 23:45:29.097138: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-17 23:45:29.145474: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2100000000 Hz
2020-05-17 23:45:29.149158: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f1c68000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-17 23:45:29.149226: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-05-17 23:45:29.836683: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x40a1fb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-05-17 23:45:29.836761: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-17 23:45:29.836784: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-17 23:45:29.836802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-17 23:45:29.836819: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-17 23:45:29.840521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.842925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:5e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.845248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:86:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.847537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 3 with properties: 
pciBusID: 0000:d8:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-17 23:45:29.847611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-17 23:45:29.847646: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-17 23:45:29.847676: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-17 23:45:29.847706: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-17 23:45:29.847736: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-17 23:45:29.847765: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-17 23:45:29.847795: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-17 23:45:29.859966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2, 3
2020-05-17 23:45:29.860025: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-17 23:45:29.865168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-17 23:45:29.865194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 2 3 
2020-05-17 23:45:29.865204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N N N 
2020-05-17 23:45:29.865211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N N N 
2020-05-17 23:45:29.865218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 2:   N N N N 
2020-05-17 23:45:29.865225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 3:   N N N N 
2020-05-17 23:45:29.870496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10203 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5)
2020-05-17 23:45:29.871977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10203 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:5e:00.0, compute capability: 7.5)
2020-05-17 23:45:29.873524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10203 MB memory) -> physical GPU (device: 2, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
2020-05-17 23:45:29.875058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10203 MB memory) -> physical GPU (device: 3, name: GeForce RTX 2080 Ti, pci bus id: 0000:d8:00.0, compute capability: 7.5)
2020-05-17 23:45:30.878572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-17 23:45:32.339305: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-17 23:45:32.835349: W tensorflow/python/util/util.cc:329] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
TensorFlow version: 2.2.0
Eager execution: True
flow sample shape:  (1, 28, 28, 1)
____________________________________________________________________________________________________
Network 	 Layer 	 Shape 						 #parameters
====================================================================================================
shift_and_log_scale_res_net
	 conv2d 		 kernel (3, 3, 1, 32) | bias (32,) 		 320
	 batch_normalization 		 gamma (32,) | beta (32,) 		 64
	 conv2d_1 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_1 		 gamma (32,) | beta (32,) 		 64
	 conv2d_2 		 kernel (3, 3, 32, 2) | bias (2,) 		 578
____________________________________________________________________________________________________
shift_and_log_scale_res_net_1
	 conv2d_3 		 kernel (3, 3, 1, 32) | bias (32,) 		 320
	 batch_normalization_2 		 gamma (32,) | beta (32,) 		 64
	 conv2d_4 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_3 		 gamma (32,) | beta (32,) 		 64
	 conv2d_5 		 kernel (3, 3, 32, 2) | bias (2,) 		 578
____________________________________________________________________________________________________
shift_and_log_scale_res_net_2
	 conv2d_6 		 kernel (3, 3, 1, 32) | bias (32,) 		 320
	 batch_normalization_4 		 gamma (32,) | beta (32,) 		 64
	 conv2d_7 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_5 		 gamma (32,) | beta (32,) 		 64
	 conv2d_8 		 kernel (3, 3, 32, 2) | bias (2,) 		 578
____________________________________________________________________________________________________
shift_and_log_scale_res_net_3
	 conv2d_9 		 kernel (3, 3, 4, 32) | bias (32,) 		 1184
	 batch_normalization_6 		 gamma (32,) | beta (32,) 		 64
	 conv2d_10 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_7 		 gamma (32,) | beta (32,) 		 64
	 conv2d_11 		 kernel (3, 3, 32, 8) | bias (8,) 		 2312
____________________________________________________________________________________________________
shift_and_log_scale_res_net_4
	 conv2d_12 		 kernel (3, 3, 4, 32) | bias (32,) 		 1184
	 batch_normalization_8 		 gamma (32,) | beta (32,) 		 64
	 conv2d_13 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_9 		 gamma (32,) | beta (32,) 		 64
	 conv2d_14 		 kernel (3, 3, 32, 8) | bias (8,) 		 2312
____________________________________________________________________________________________________
shift_and_log_scale_res_net_5
	 conv2d_15 		 kernel (3, 3, 4, 32) | bias (32,) 		 1184
	 batch_normalization_10 		 gamma (32,) | beta (32,) 		 64
	 conv2d_16 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_11 		 gamma (32,) | beta (32,) 		 64
	 conv2d_17 		 kernel (3, 3, 32, 8) | bias (8,) 		 2312
____________________________________________________________________________________________________
shift_and_log_scale_res_net_6
	 conv2d_18 		 kernel (3, 3, 2, 64) | bias (64,) 		 1216
	 batch_normalization_12 		 gamma (64,) | beta (64,) 		 128
	 conv2d_19 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_13 		 gamma (64,) | beta (64,) 		 128
	 conv2d_20 		 kernel (3, 3, 64, 4) | bias (4,) 		 2308
____________________________________________________________________________________________________
shift_and_log_scale_res_net_7
	 conv2d_21 		 kernel (3, 3, 2, 64) | bias (64,) 		 1216
	 batch_normalization_14 		 gamma (64,) | beta (64,) 		 128
	 conv2d_22 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_15 		 gamma (64,) | beta (64,) 		 128
	 conv2d_23 		 kernel (3, 3, 64, 4) | bias (4,) 		 2308
____________________________________________________________________________________________________
shift_and_log_scale_res_net_8
	 conv2d_24 		 kernel (3, 3, 2, 64) | bias (64,) 		 1216
	 batch_normalization_16 		 gamma (64,) | beta (64,) 		 128
	 conv2d_25 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_17 		 gamma (64,) | beta (64,) 		 128
	 conv2d_26 		 kernel (3, 3, 64, 4) | bias (4,) 		 2308
____________________________________________________________________________________________________
shift_and_log_scale_res_net_9
	 conv2d_27 		 kernel (3, 3, 8, 64) | bias (64,) 		 4672
	 batch_normalization_18 		 gamma (64,) | beta (64,) 		 128
	 conv2d_28 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_19 		 gamma (64,) | beta (64,) 		 128
	 conv2d_29 		 kernel (3, 3, 64, 16) | bias (16,) 		 9232
____________________________________________________________________________________________________
shift_and_log_scale_res_net_10
	 conv2d_30 		 kernel (3, 3, 8, 64) | bias (64,) 		 4672
	 batch_normalization_20 		 gamma (64,) | beta (64,) 		 128
	 conv2d_31 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_21 		 gamma (64,) | beta (64,) 		 128
	 conv2d_32 		 kernel (3, 3, 64, 16) | bias (16,) 		 9232
____________________________________________________________________________________________________
shift_and_log_scale_res_net_11
	 conv2d_33 		 kernel (3, 3, 8, 64) | bias (64,) 		 4672
	 batch_normalization_22 		 gamma (64,) | beta (64,) 		 128
	 conv2d_34 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_23 		 gamma (64,) | beta (64,) 		 128
	 conv2d_35 		 kernel (3, 3, 64, 16) | bias (16,) 		 9232
====================================================================================================
Total Trainable Variables:  99066
Start  Training on 100 epochs
Epoch 000: Loss: -1268.316
Epoch 001: Loss: -1223.438
Epoch 002: Loss: -1448.916
Epoch 003: Loss: -1573.078
Epoch 004: Loss: -1453.684
Epoch 005: Loss: -1631.985
Epoch 006: Loss: -1715.018
Epoch 007: Loss: -1734.238
Epoch 008: Loss: -1629.207
Epoch 009: Loss: -1739.487
Epoch 010: Loss: -1315.071
Epoch 011: Loss: -1321.264
Epoch 012: Loss: -1339.829
Epoch 013: Loss: -1446.387
Epoch 014: Loss: -1674.758
Epoch 015: Loss: -1752.877
Epoch 016: Loss: -1658.916
Epoch 017: Loss: -1732.373
Epoch 018: Loss: -1725.080
Epoch 019: Loss: -1619.378
Epoch 020: Loss: -1738.828
Epoch 021: Loss: -1657.505
Epoch 022: Loss: -1713.793
Epoch 023: Loss: -1701.157
Epoch 024: Loss: -1798.815
Epoch 025: Loss: -1706.886
Epoch 026: Loss: -1664.371
Epoch 027: Loss: -1785.292
Epoch 028: Loss: -1727.187
Epoch 029: Loss: -1752.523
Epoch 030: Loss: -1724.449
Epoch 031: Loss: -1771.588
Epoch 032: Loss: -1650.892
Epoch 033: Loss: -1817.058
Epoch 034: Loss: -1472.936
Epoch 035: Loss: -1433.362
Epoch 036: Loss: -1466.795
Epoch 037: Loss: -1426.903
Epoch 038: Loss: -1531.984
Epoch 039: Loss: -1262.150
Epoch 040: Loss: -1344.023
Epoch 041: Loss: -1656.727
Epoch 042: Loss: -1630.309
Epoch 043: Loss: -1698.976
Epoch 044: Loss: -1731.180
Epoch 045: Loss: -1787.903
Epoch 046: Loss: -1694.576
Epoch 047: Loss: -1730.174
Epoch 048: Loss: -1724.579
Epoch 049: Loss: -1669.799
Epoch 050: Loss: -1610.013
Epoch 051: Loss: -1731.393
Epoch 052: Loss: -1779.834
Epoch 053: Loss: -1795.899
Epoch 054: Loss: -1790.763
Epoch 055: Loss: -1652.634
Epoch 056: Loss: -1822.398
Epoch 057: Loss: -1794.336
Epoch 058: Loss: -1826.993
Epoch 059: Loss: -1800.398
Epoch 060: Loss: -1822.912
Epoch 061: Loss: -1844.593
Epoch 062: Loss: -1887.288
Epoch 063: Loss: -1852.765
Epoch 064: Loss: -1855.600
Epoch 065: Loss: -1823.468
Epoch 066: Loss: -1866.199
Epoch 067: Loss: -1879.096
Epoch 068: Loss: -1646.935
Epoch 069: Loss: -1677.154
Epoch 070: Loss: -1838.677
Epoch 071: Loss: -1722.637
Epoch 072: Loss: -1740.646
Epoch 073: Loss: -1833.943
Epoch 074: Loss: -1840.739
Epoch 075: Loss: -1741.313
Epoch 076: Loss: -1850.780
Epoch 077: Loss: -1831.842
Epoch 078: Loss: -1853.900
Epoch 079: Loss: -1870.983
Epoch 080: Loss: -1885.516
Epoch 081: Loss: -1870.012
Epoch 082: Loss: -1941.916
Epoch 083: Loss: -1715.377
Epoch 084: Loss: -1870.849
Epoch 085: Loss: -1881.556
Epoch 086: Loss: -1706.903
Epoch 087: Loss: -1854.506
Epoch 088: Loss: -1887.926
Epoch 089: Loss: -1897.462
Epoch 090: Loss: -1876.816
Epoch 091: Loss: -1789.934
Epoch 092: Loss: -1815.396
Epoch 093: Loss: -1857.750
Epoch 094: Loss: -1864.204
Epoch 095: Loss: -1897.040
Epoch 096: Loss: -1900.255
Epoch 097: Loss: -1735.711
Epoch 098: Loss: -1704.417
Epoch 099: Loss: -1817.131
