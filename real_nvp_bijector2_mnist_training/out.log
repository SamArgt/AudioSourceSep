2020-05-18 22:47:42.198633: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-18 22:47:45.454076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:45.454862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:5e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:45.455572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:86:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:45.456272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 3 with properties: 
pciBusID: 0000:d8:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:45.456539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-18 22:47:45.458279: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-18 22:47:45.460216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-18 22:47:45.460523: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-18 22:47:45.462615: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-18 22:47:45.463671: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-18 22:47:45.467692: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-18 22:47:45.473446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2, 3
2020-05-18 22:47:45.474975: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-18 22:47:45.505482: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2100000000 Hz
2020-05-18 22:47:45.508611: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f96f4000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-18 22:47:45.508705: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-05-18 22:47:46.198700: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x44a1a10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-05-18 22:47:46.198780: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-18 22:47:46.198802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-18 22:47:46.198819: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-18 22:47:46.198835: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-18 22:47:46.202509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:46.204854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:5e:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:46.207132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:86:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:46.209401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 3 with properties: 
pciBusID: 0000:d8:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-18 22:47:46.209478: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-18 22:47:46.209511: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-18 22:47:46.209540: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-18 22:47:46.209570: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-18 22:47:46.209599: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-18 22:47:46.209626: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-18 22:47:46.209656: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-18 22:47:46.222146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2, 3
2020-05-18 22:47:46.222204: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-18 22:47:46.227451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-18 22:47:46.227473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 2 3 
2020-05-18 22:47:46.227483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N N N 
2020-05-18 22:47:46.227491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N N N 
2020-05-18 22:47:46.227497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 2:   N N N N 
2020-05-18 22:47:46.227504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 3:   N N N N 
2020-05-18 22:47:46.232787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10203 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5)
2020-05-18 22:47:46.234433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10203 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:5e:00.0, compute capability: 7.5)
2020-05-18 22:47:46.235860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10203 MB memory) -> physical GPU (device: 2, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
2020-05-18 22:47:46.237358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10203 MB memory) -> physical GPU (device: 3, name: GeForce RTX 2080 Ti, pci bus id: 0000:d8:00.0, compute capability: 7.5)
2020-05-18 22:47:47.273478: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-18 22:47:48.716391: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-18 22:47:49.271640: W tensorflow/python/util/util.cc:329] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
TensorFlow version: 2.2.0
Eager execution: True
flow sample shape:  (1, 28, 28, 1)
____________________________________________________________________________________________________
Network 	 Layer 	 Shape 						 #parameters
====================================================================================================
shift_and_log_scale_res_net
	 conv2d 		 kernel (3, 3, 1, 32) | bias (32,) 		 320
	 batch_normalization 		 gamma (32,) | beta (32,) 		 64
	 conv2d_1 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_1 		 gamma (32,) | beta (32,) 		 64
	 conv2d_2 		 kernel (3, 3, 32, 2) | bias (2,) 		 578
____________________________________________________________________________________________________
shift_and_log_scale_res_net_1
	 conv2d_3 		 kernel (3, 3, 1, 32) | bias (32,) 		 320
	 batch_normalization_2 		 gamma (32,) | beta (32,) 		 64
	 conv2d_4 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_3 		 gamma (32,) | beta (32,) 		 64
	 conv2d_5 		 kernel (3, 3, 32, 2) | bias (2,) 		 578
____________________________________________________________________________________________________
shift_and_log_scale_res_net_2
	 conv2d_6 		 kernel (3, 3, 1, 32) | bias (32,) 		 320
	 batch_normalization_4 		 gamma (32,) | beta (32,) 		 64
	 conv2d_7 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_5 		 gamma (32,) | beta (32,) 		 64
	 conv2d_8 		 kernel (3, 3, 32, 2) | bias (2,) 		 578
____________________________________________________________________________________________________
shift_and_log_scale_res_net_3
	 conv2d_9 		 kernel (3, 3, 4, 32) | bias (32,) 		 1184
	 batch_normalization_6 		 gamma (32,) | beta (32,) 		 64
	 conv2d_10 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_7 		 gamma (32,) | beta (32,) 		 64
	 conv2d_11 		 kernel (3, 3, 32, 8) | bias (8,) 		 2312
____________________________________________________________________________________________________
shift_and_log_scale_res_net_4
	 conv2d_12 		 kernel (3, 3, 4, 32) | bias (32,) 		 1184
	 batch_normalization_8 		 gamma (32,) | beta (32,) 		 64
	 conv2d_13 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_9 		 gamma (32,) | beta (32,) 		 64
	 conv2d_14 		 kernel (3, 3, 32, 8) | bias (8,) 		 2312
____________________________________________________________________________________________________
shift_and_log_scale_res_net_5
	 conv2d_15 		 kernel (3, 3, 4, 32) | bias (32,) 		 1184
	 batch_normalization_10 		 gamma (32,) | beta (32,) 		 64
	 conv2d_16 		 kernel (1, 1, 32, 32) | bias (32,) 		 1056
	 batch_normalization_11 		 gamma (32,) | beta (32,) 		 64
	 conv2d_17 		 kernel (3, 3, 32, 8) | bias (8,) 		 2312
____________________________________________________________________________________________________
shift_and_log_scale_res_net_6
	 conv2d_18 		 kernel (3, 3, 2, 64) | bias (64,) 		 1216
	 batch_normalization_12 		 gamma (64,) | beta (64,) 		 128
	 conv2d_19 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_13 		 gamma (64,) | beta (64,) 		 128
	 conv2d_20 		 kernel (3, 3, 64, 4) | bias (4,) 		 2308
____________________________________________________________________________________________________
shift_and_log_scale_res_net_7
	 conv2d_21 		 kernel (3, 3, 2, 64) | bias (64,) 		 1216
	 batch_normalization_14 		 gamma (64,) | beta (64,) 		 128
	 conv2d_22 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_15 		 gamma (64,) | beta (64,) 		 128
	 conv2d_23 		 kernel (3, 3, 64, 4) | bias (4,) 		 2308
____________________________________________________________________________________________________
shift_and_log_scale_res_net_8
	 conv2d_24 		 kernel (3, 3, 2, 64) | bias (64,) 		 1216
	 batch_normalization_16 		 gamma (64,) | beta (64,) 		 128
	 conv2d_25 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_17 		 gamma (64,) | beta (64,) 		 128
	 conv2d_26 		 kernel (3, 3, 64, 4) | bias (4,) 		 2308
____________________________________________________________________________________________________
shift_and_log_scale_res_net_9
	 conv2d_27 		 kernel (3, 3, 8, 64) | bias (64,) 		 4672
	 batch_normalization_18 		 gamma (64,) | beta (64,) 		 128
	 conv2d_28 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_19 		 gamma (64,) | beta (64,) 		 128
	 conv2d_29 		 kernel (3, 3, 64, 16) | bias (16,) 		 9232
____________________________________________________________________________________________________
shift_and_log_scale_res_net_10
	 conv2d_30 		 kernel (3, 3, 8, 64) | bias (64,) 		 4672
	 batch_normalization_20 		 gamma (64,) | beta (64,) 		 128
	 conv2d_31 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_21 		 gamma (64,) | beta (64,) 		 128
	 conv2d_32 		 kernel (3, 3, 64, 16) | bias (16,) 		 9232
____________________________________________________________________________________________________
shift_and_log_scale_res_net_11
	 conv2d_33 		 kernel (3, 3, 8, 64) | bias (64,) 		 4672
	 batch_normalization_22 		 gamma (64,) | beta (64,) 		 128
	 conv2d_34 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_23 		 gamma (64,) | beta (64,) 		 128
	 conv2d_35 		 kernel (3, 3, 64, 16) | bias (16,) 		 9232
____________________________________________________________________________________________________
shift_and_log_scale_res_net_12
	 conv2d_36 		 kernel (3, 3, 4, 64) | bias (64,) 		 2368
	 batch_normalization_24 		 gamma (64,) | beta (64,) 		 128
	 conv2d_37 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_25 		 gamma (64,) | beta (64,) 		 128
	 conv2d_38 		 kernel (3, 3, 64, 8) | bias (8,) 		 4616
____________________________________________________________________________________________________
shift_and_log_scale_res_net_13
	 conv2d_39 		 kernel (3, 3, 4, 64) | bias (64,) 		 2368
	 batch_normalization_26 		 gamma (64,) | beta (64,) 		 128
	 conv2d_40 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_27 		 gamma (64,) | beta (64,) 		 128
	 conv2d_41 		 kernel (3, 3, 64, 8) | bias (8,) 		 4616
____________________________________________________________________________________________________
shift_and_log_scale_res_net_14
	 conv2d_42 		 kernel (3, 3, 4, 64) | bias (64,) 		 2368
	 batch_normalization_28 		 gamma (64,) | beta (64,) 		 128
	 conv2d_43 		 kernel (1, 1, 64, 64) | bias (64,) 		 4160
	 batch_normalization_29 		 gamma (64,) | beta (64,) 		 128
	 conv2d_44 		 kernel (3, 3, 64, 8) | bias (8,) 		 4616
====================================================================================================
Total Trainable Variables:  133266
Start  Training on 100 epochs
Epoch 000: Loss: -1406.780
Epoch 001: Loss: -1678.769
Epoch 002: Loss: -1482.985
Epoch 003: Loss: -1500.442
Epoch 004: Loss: 1020.559
Epoch 005: Loss: -1259.366
Epoch 006: Loss: -1712.728
Epoch 007: Loss: -664.836
Epoch 008: Loss: -1364.583
Epoch 009: Loss: -1409.989
Epoch 010: Loss: -1113.345
Epoch 011: Loss: -966.722
Epoch 012: Loss: -1293.334
Epoch 013: Loss: -891.639
Epoch 014: Loss: -1458.995
Epoch 015: Loss: -661.369
Epoch 016: Loss: -1464.392
Epoch 017: Loss: -1329.538
Epoch 018: Loss: -305.655
Epoch 019: Loss: -1019.071
Epoch 020: Loss: -1376.128
Epoch 021: Loss: -1464.312
Epoch 022: Loss: -787.654
Epoch 023: Loss: -1433.863
Epoch 024: Loss: -1486.614
Epoch 025: Loss: -1546.097
Epoch 026: Loss: -1251.829
Epoch 027: Loss: -1087.633
Epoch 028: Loss: -1485.961
Epoch 029: Loss: -1553.717
Epoch 030: Loss: -1146.378
Epoch 031: Loss: -1222.664
Epoch 032: Loss: -1081.267
Epoch 033: Loss: -1045.106
Epoch 034: Loss: -1244.770
Epoch 035: Loss: -1532.549
Epoch 036: Loss: -1333.202
Epoch 037: Loss: -1354.346
Epoch 038: Loss: -704.350
Epoch 039: Loss: -1144.319
Epoch 040: Loss: -1567.439
Epoch 041: Loss: -1505.957
Epoch 042: Loss: -1759.856
Epoch 043: Loss: -1477.485
Epoch 044: Loss: -1736.497
Epoch 045: Loss: -1173.956
Epoch 046: Loss: -1581.643
Epoch 047: Loss: -1619.743
Epoch 048: Loss: -1641.507
Epoch 049: Loss: -1548.073
Epoch 050: Loss: -1656.053
Epoch 051: Loss: -1874.477
Epoch 052: Loss: -1522.838
Epoch 053: Loss: -1395.973
Epoch 054: Loss: -1776.188
Epoch 055: Loss: -1456.246
Epoch 056: Loss: -1337.967
Epoch 057: Loss: -1552.072
Epoch 058: Loss: -1802.899
Epoch 059: Loss: -1700.117
Epoch 060: Loss: -1775.586
Epoch 061: Loss: -1526.279
Epoch 062: Loss: -1734.000
Epoch 063: Loss: -1925.670
Epoch 064: Loss: -1811.050
Epoch 065: Loss: -1838.266
Epoch 066: Loss: -1858.634
Epoch 067: Loss: -1416.926
Epoch 068: Loss: -984.511
Epoch 069: Loss: -1494.860
Epoch 070: Loss: -1747.179
Epoch 071: Loss: -1628.403
Epoch 072: Loss: -1705.340
Epoch 073: Loss: -1732.859
Epoch 074: Loss: -1511.860
Epoch 075: Loss: -1556.160
Epoch 076: Loss: -1687.088
Epoch 077: Loss: -1372.196
Epoch 078: Loss: -1212.002
Epoch 079: Loss: -1289.330
Epoch 080: Loss: -1329.762
Epoch 081: Loss: -1377.766
Epoch 082: Loss: -1384.207
Epoch 083: Loss: -1402.842
Epoch 084: Loss: -1401.505
Epoch 085: Loss: -1382.972
Epoch 086: Loss: -1298.452
Epoch 087: Loss: -1411.565
Epoch 088: Loss: -1379.744
Epoch 089: Loss: -1270.123
Epoch 090: Loss: -1623.781
Epoch 091: Loss: -1564.749
Epoch 092: Loss: -1821.686
Epoch 093: Loss: -1104.014
Epoch 094: Loss: -1539.541
Epoch 095: Loss: -1678.053
Epoch 096: Loss: -1729.190
Epoch 097: Loss: -1866.029
Epoch 098: Loss: -1747.643
Epoch 099: Loss: -1804.994
Training time:  8228.34  seconds
loss history saved
9 samples saved
